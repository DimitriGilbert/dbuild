<!doctype html><html lang=en-us><head><title>Unit tests for parseArger // DBuild</title><link rel="shortcut icon" href=/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.111.3"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="D"><meta name=description content><link rel=stylesheet href=/css/main.min.4c093c2392ba07d2bb0df19e873341a0fdd7cbf687e94eea8f060d31a12b226b.css><meta name=twitter:card content="summary"><meta name=twitter:title content="Unit tests for parseArger"><meta name=twitter:description content="Unit tests for me, unit tests for you, unit tests for everyone !"><meta property="og:title" content="Unit tests for parseArger"><meta property="og:description" content="Unit tests for me, unit tests for you, unit tests for everyone !"><meta property="og:type" content="article"><meta property="og:url" content="https://dbuild.dev/projects/parsearger/unit-tests-for-parsearger/"><meta property="article:section" content="Projects"><meta property="article:published_time" content="2024-02-28T11:13:43+01:00"><meta property="article:modified_time" content="2024-02-28T11:13:43+01:00"><script src=https://cdn.counter.dev/script.js data-id=154c6878-7558-4eff-90f9-bd4904015df1 data-utcoffset=1></script></head><body><header class=app-header><a href=https://dbuild.dev><img class=app-header-avatar src=/logo.png alt=D></a>
<a href=https://dbuild.dev class=app-header-title>DBuild</a><p>I am D, I build things</p><div class=app-header-social><a href=https://github.com/DimitriGilbert target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>Github</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=/index.xml target=_blank rel="noreferrer noopener me"><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-rss"><title>RSS</title><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></div><nav class=app-header-menu><div><a class=app-header-menu-item href=/projects/>Projects</a></div>-<div><a class=app-header-menu-item href=/tags/tutorial>Tutorials</a></div>-<div><a class=app-header-menu-item href=/tags/devlog>DeVlog</a></div>-<div><a class=app-header-menu-item href=/black-hole>Black Hole</a></div></nav></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>Unit tests for parseArger</h1><div class=post-meta><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Feb 28, 2024</div><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>3 min read</div><div><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag"><title>tag</title><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7.01" y2="7"/></svg><a class=tag href=https://dbuild.dev/tags/bash/>bash</a>
<a class=tag href=https://dbuild.dev/tags/terminal/>terminal</a>
<a class=tag href=https://dbuild.dev/tags/scripting/>scripting</a>
<a class=tag href=https://dbuild.dev/tags/parsearger/>parseArger</a>
<a class=tag href=https://dbuild.dev/tags/devlog/>devlog</a></div></div></header><div class=post-content><div class=post-cnt><p>Do you like unit tests ? I don&rsquo;t, but they are useful&mldr; I&rsquo;ll probably go at it in a <a href=/black-hole>Black hole</a> at some point&mldr;</p><p>But for now, rejoyce ! parseArger is not (mostly) unit tested, yay !</p><p>And as a bonus, you guys get to enjoy basic project unit tests generation ! What is not to like, hum ?</p><h2 id=bash-and-unit-test>Bash and unit test</h2><p>I&rsquo;ve had a few looks at bash unit testing in the past and, maybe because of my complicated relationship with unit tests, I did always put it off&mldr; this time, well&mldr;, it was time.</p><p>ParseArger definitly grew enough to need them so&mldr;.</p><p>I settled on <a href=https://bashunit.typeddevs.com/>Bashunit</a>.</p><p>Is it the best ? I dunno&mldr;</p><p>The most complete ? dunno&mldr;</p><p>Fastest, easiest, anything &mldr; ? mehh, dunno&mldr;</p><p>It&rsquo;s there, updated, decently documented, and I will hate it at some point, so might as well go with that.</p><p>I know it&rsquo;s not the most convincing argumentation for a tool, but sometimes, the only bad choice is not choosing. And here, everything seems more or less equal.</p><p>Once the lib is chosen, a quick install <code>curl -s https://bashunit.typeddevs.com/install.sh | bash</code> (<a href=https://bashunit.typeddevs.com/installation>see doc for more info</a>) and boom, I got my testing lib !</p><h2 id=run-the-parsearger-tests>Run the parseArger tests</h2><p>I won&rsquo;t bother you with writing about unit test writing&mldr; it would be boring out the boring&mldr;</p><p><a href=https://bashunit.typeddevs.com/>Bashunit documentation</a> has some great example and you can always check <a href=https://github.com/DimitriGilbert/parseArger/tree/main/tests>parseArger tests folder</a> for more examples ;)</p><p>I just wrote all that to inform you that, if youd like, once parseArger is installed, you could run its tests !</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># go to ionstall folder</span>
</span></span><span style=display:flex><span>cd /parseArger/install/folder
</span></span><span style=display:flex><span><span style=color:#75715e># run the tests</span>
</span></span><span style=display:flex><span>./lib/bashunit ./tests
</span></span></code></pre></div><h3 id=i-want-to-shame-you-with-coverage->I want to shame you with coverage !</h3><p>Sure, if I felt shame about that ^^.</p><p>Now it can still be an interresting metrics, so I use <a href=https://github.com/infertux/bashcov><code>bashcov</code></a> for that and it works as follow :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># go to ionstall folder</span>
</span></span><span style=display:flex><span>cd /parseArger/install/folder
</span></span><span style=display:flex><span><span style=color:#75715e># run the tests</span>
</span></span><span style=display:flex><span>bashcov ./lib/bashunit ./tests
</span></span></code></pre></div><p>Because a bunch of temporary script are generated and removed, <a href=https://github.com/infertux/bashcov>bashcov</a> spits a bunch of warnings that do not matter (annoying nonetheless&mldr;).</p><p>A new directory <code>coverage</code> will contain <a href=https://github.com/infertux/bashcov>bashcov</a> html output.</p><p>Note that you will have to install <a href=https://github.com/infertux/bashcov>bashcov</a> on your own !</p><h2 id=unit-tests-for-your-project->Unit tests for YOUR project !</h2><p>Yep, that&rsquo;s right ! <code>parseArger project</code> can now install bashunit AND generate basic test files for your command and sub-commands.</p><p>It will just run your command <code>help</code> for now, but this will probably get worked on in the future (testing every argument, option, flag, one-ofs, etc &mldr;)</p><p>just use the <code>--unit-test</code> flag on your project command :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>parseArger project my-project --unit-tests <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --project-subcommand cmd-one <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --project-subcommand cmd-2
</span></span></code></pre></div><p>Then to run your newly created fatastic and wonderful unit tests, run the following :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd my-project
</span></span><span style=display:flex><span>./lib/bashunit ./tests
</span></span></code></pre></div><p>And now the only excuse you have not to write unit tests for your bash programs, is your very own lazyness (what ? I suffered through it so if you won&rsquo;t, you&rsquo;ll at least feel guilt 3:D, you are welcome :) )</p><h2 id=what-now->What now ?</h2><p>I&rsquo;ve done the antagonizing bit just above, so now comes the balm :</p><ul><li>it is easy</li><li>it is fairly fast</li><li>you will thank yourself (me ? &mldr;) later !</li></ul><p>If nothing else, you can just run your command to make sure it exists nicely ;)</p><p>As always, you can report <a href="https://github.com/DimitriGilbert/parseArger/issues/new?assignees=&amp;labels=&amp;projects=&amp;template=bug_report.md&amp;title=">issues</a> or <a href="https://github.com/DimitriGilbert/parseArger/issues/new?assignees=&amp;labels=&amp;projects=&amp;template=feature_request.md&amp;title=">suggest ideas</a> on <a href=https://github.com/DimitriGilbert/parseArger/>parseArger github repository</a>. Or even better, you can submit <a href=https://github.com/DimitriGilbert/parseArger/compare>a pull request</a> if you added something you find meaningful.</p><p>Thanks for the read and I hope you found it useful (or at least entertaining :D )</p><p>See you around and happy coding !</p></div></div><div class=post-footer></div></article></main></body></html>